<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Dual Challenge - Flappy Bird √ó Subway Surfers</title>
    <meta name="description"
        content="The ultimate multitasking challenge: Play Flappy Bird and Subway Surfers simultaneously!">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;600;800;900&family=Press+Start+2P&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="styles.css?v=2">
    <link rel="stylesheet" href="mobile-styles.css">
    <link rel="stylesheet" href="ios-styles.css">
    <link rel="manifest" href="manifest.json">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
</head>

<body>
    <div class="mesh-background">
        <div class="mesh-blob blob-1"></div>
        <div class="mesh-blob blob-2"></div>
        <div class="mesh-blob blob-3"></div>
    </div>
    <div class="game-container">
        <!-- Split screen canvases -->
        <div class="split-container">
            <div class="game-panel left-panel">
                <canvas id="flappyCanvas"></canvas>
                <div class="panel-label">FLAPPY BIRD</div>
                <div class="control-hint">Tap üëÜ</div>
            </div>
            <div class="divider"></div>
            <div class="game-panel middle-panel">
                <div id="pongContainer"></div>
                <div class="panel-label">3D PONG</div>
                <div class="control-hint">Tilt üì±</div>
            </div>
            <div class="divider"></div>
            <div class="game-panel right-panel">
                <canvas id="subwayCanvas"></canvas>
                <div class="panel-label">SUBWAY SURFERS</div>
                <div class="control-hint">Swipe ‚ÜîÔ∏è</div>
            </div>
        </div>

        <!-- UI Overlay -->
        <div class="ui-overlay">
            <div class="score-display">
                <div class="score-section">
                    <div class="score-label">FLAPPY</div>
                    <div class="score-value" id="flappyScore">0</div>
                </div>
                <div class="score-divider">|</div>
                <div class="score-section">
                    <div class="score-label">PONG</div>
                    <div class="score-value" id="pongScore">0</div>
                </div>
                <div class="score-divider">|</div>
                <div class="score-section">
                    <div class="score-label">SUBWAY</div>
                    <div class="score-value" id="subwayScore">0</div>
                </div>
            </div>

            <div class="total-score-display">
                <div class="total-label">TOTAL SCORE</div>
                <div class="total-value" id="totalScore">0</div>
            </div>

            <div class="high-score-display">
                <div class="high-score-label">BEST</div>
                <div class="high-score-value" id="highScore">0</div>
            </div>

            <!-- In-Game Fullscreen Button -->
            <button id="inGameFullscreenBtn" class="ingame-fullscreen-btn" aria-label="Fullscreen">
                ‚õ∂
            </button>
        </div>

        <!-- Start Screen -->
        <div class="start-screen" id="startScreen">
            <div class="title-container">
                <h1 class="game-title">
                    <span class="title-dual">DUAL</span>
                    <span class="title-challenge">CHALLENGE</span>
                </h1>
                <div class="subtitle-container">
                    <div class="subtitle-game">
                        <span class="emoji">üê¶</span>
                        <span>Flappy Bird</span>
                    </div>
                    <div class="subtitle-x">√ó</div>
                    <div class="subtitle-game">
                        <span class="emoji">üèì</span>
                        <span>3D Pong</span>
                    </div>
                    <div class="subtitle-x">√ó</div>
                    <div class="subtitle-game">
                        <span class="emoji">üèÉ</span>
                        <span>Subway Surfers</span>
                    </div>
                </div>
                <p class="game-instructions">
                    <strong>Controls:</strong><br>
                    <span class="control-item">üê¶ Tap = Jump</span>
                    <span class="control-separator">‚Ä¢</span>
                    <span class="control-item">üèì X/V = Paddle</span>
                    <span class="control-separator">‚Ä¢</span>
                    <span class="control-item">üèÉ Swipe = Lanes</span>
                </p>
                <p class="game-warning">‚ö†Ô∏è Die in either game = GAME OVER</p>
            </div>
            <button class="start-button" id="startButton">
                <span class="button-text">START DUAL CHALLENGE</span>
                <span class="button-icon">üöÄ</span>
            </button>
            <div class="start-screen-buttons">
                <button class="view-leaderboard-button" id="startScreenLeaderboardBtn">
                    LEADERBOARD üìú
                </button>
                <button class="fullscreen-button" id="fullscreenBtn">
                    üì± FULLSCREEN
                </button>
            </div>
        </div>

        <!-- Game Over Screen -->
        <div class="game-over-screen hidden" id="gameOverScreen">
            <div class="game-over-container">
                <h2 class="game-over-title">GAME OVER!</h2>
                <div class="death-indicator" id="deathIndicator">
                    <span id="deathMessage"></span>
                </div>
                <div class="final-scores">
                    <div class="final-score-item">
                        <div class="final-score-label">üê¶ Flappy Bird</div>
                        <div class="final-score-value" id="finalFlappyScore">0</div>
                    </div>
                    <div class="final-score-item">
                        <div class="final-score-label">üèì 3D Pong</div>
                        <div class="final-score-value" id="finalPongScore">0</div>
                    </div>
                    <div class="final-score-item">
                        <div class="final-score-label">üèÉ Subway Surfers</div>
                        <div class="final-score-value" id="finalSubwayScore">0</div>
                    </div>
                    <div class="final-score-total">
                        <div class="final-total-label">TOTAL SCORE</div>
                        <div class="final-total-value" id="finalTotalScore">0</div>
                    </div>
                </div>

                <div class="leaderboard-section">
                    <input type="text" id="playerNameInput" placeholder="Enter Name for Leaderboard" maxlength="15"
                        class="player-name-input">
                    <button class="submit-score-button" id="submitScoreButton">
                        SUBMIT SCORE üèÜ
                    </button>
                </div>

                <div class="game-over-buttons">
                    <button class="restart-button" id="restartButton">
                        <span class="button-text">TRY AGAIN</span>
                        <span class="button-icon">üîÑ</span>
                    </button>
                    <button class="view-leaderboard-button" id="viewLeaderboardButton">
                        LEADERBOARD üìú
                    </button>
                    <button class="fullscreen-button" id="gameOverFullscreenBtn">
                        üì± FULLSCREEN
                    </button>
                </div>
            </div>
        </div>
        <!-- <button class="reset-score-button" id="resetScoreButton">
            RESET LOCAL BEST
        </button> -->
    </div>

    <!-- Rotate Device Message -->
    <div class="rotate-message" id="rotateMessage">
        <div class="rotate-icon">üì±</div>
        <h2>PLEASE ROTATE DEVICE</h2>
        <p>This game is best experienced in landscape mode.</p>
    </div>

    <!-- iOS Fullscreen Instructions Modal -->
    <div class="ios-modal hidden" id="iosModal">
        <div class="ios-modal-content">
            <div class="ios-header">
                <h3>üì± Fullscreen on iOS</h3>
                <button class="close-ios" id="closeIosModal">√ó</button>
            </div>
            <p>iOS Safari doesn't support a fullscreen button.</p>
            <p><strong>To play fullscreen:</strong></p>
            <ol>
                <li>Tap the <strong>Share</strong> button <span class="share-icon">‚éã</span></li>
                <li>Scroll down and tap <strong>"Add to Home Screen"</strong> ‚ûï</li>
                <li>Launch the game from your home screen! üöÄ</li>
            </ol>
        </div>
    </div>

    <!-- Leaderboard Modal -->
    <div class="leaderboard-modal hidden" id="leaderboardModal">
        <div class="leaderboard-container">
            <div class="leaderboard-header">
                <h2>GLOBAL TOP 10</h2>
                <button class="close-leaderboard" id="closeLeaderboard">√ó</button>
            </div>
            <div class="leaderboard-tabs">
                <button class="tab-btn active" id="tabThisWeek">This Week</button>
                <button class="tab-btn" id="tabAllTime">All Time</button>
            </div>
            <div class="leaderboard-list" id="leaderboardList">
                <div class="loading-spinner">Loading...</div>
                <!-- populated by js -->
            </div>
        </div>

        <!-- Firebase SDKs -->
        <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
        <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>

        <!-- Three.js for 3D Pong -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>

        <script type="module" src="js/main.js"></script>
</body>

</html>